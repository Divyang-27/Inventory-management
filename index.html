<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product-List</title>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    ></script>
  </head>
  <body>
    <form action="#" onSubmit="getOrder(event)">
      <label for="Sellingprice"> Selling Price:</label>
      <input type="number" id="Sellingprice" required />
      <label for="item"> Product-Name:</label>
      <input type="text" id="item" required />
      <label for="Category">Category:</label>
      <select id="Category" required>
        <option value="Electronics">Electronics-Item</option>
        <option value="Food">Food-Item</option>
        <option value="Skincare">Skincare-Item</option>
      </select>
      <button type="submit">Add Product</button>

      <ul id="Electroniclist">
        <h1>Electronics-Item</h1>
      </ul>

      <ul id="Foodlist">
        <h1>Food-Item</h1>
      </ul>
      <ul id="Skincarelist">
        <h1>Skincare-Item</h1>
      </ul>
    </form>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"></script>

    <script>
      let orderObj;

      function getOrder(e) {
        e.preventDefault();
        const price = e.target.Sellingprice.value;
        const product = e.target.item.value;
        const category = e.target.Category.value;
        orderObj = {
          price: price,
          product: product,
          category: category,
        };
        axios
          .post(
            "https://crudcrud.com/api/bcecba3a86cb49878e5c491feb916e54/orderInventory",
            orderObj
          )
          .then((res) => {
            showData(res.data);
          })
          .catch((err) => console.log(err));
      }

      function showData(orderObj) {
        const li = document.createElement("li");
        const deleteBtn = document.createElement("button");
        let parentEle;

        if (orderObj.category === "Electronics") {
          parentEle = document.getElementById("Electroniclist");
        } else if (orderObj.category === "Food") {
          parentEle = document.getElementById("Foodlist");
        } else if (orderObj.category === "Skincare") {
          parentEle = document.getElementById("Skincarelist");
        }

        deleteBtn.innerHTML = "Delete Product";
        li.innerHTML = `${orderObj.price} ${orderObj.product} ${orderObj.category}`;
        li.appendChild(deleteBtn);

        if (parentEle) {
          parentEle.appendChild(li);

          deleteBtn.onclick = () => {
            parentEle.removeChild(li);
            axios
              .delete(
                `https://crudcrud.com/api/bcecba3a86cb49878e5c491feb916e54/orderInventory/${orderObj._id}`
              )
              .then(() => console.log("Order Deleted"))
              .catch(() => console.log("Something Went wrong"));
          };
        }
      }

      window.onload = () => {
        axios
          .get(
            "https://crudcrud.com/api/bcecba3a86cb49878e5c491feb916e54/orderInventory"
          )
          .then((res) => {
            res.data.forEach((data) => {
              showData(data);
            });
          })
          .catch((err) => console.log("Something Went wrong", err));
      };
    </script>
  </body>
</html>
